<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Habit Tracker</title>
    <style>
        /* CSS को अन्य पेजों के साथ सुसंगत रखने के लिए */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            /* हल्का, आकर्षक बैकग्राउंड */
            background: linear-gradient(135deg, #f3f4f6 0%, #e0e7ff 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #333;
        }
        .dashboard-container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 800px;
            padding: 40px;
            text-align: center;
            /* शुरुआत में छिपा हुआ */
            display: none; 
        }
        h1 { color: #667eea; margin-bottom: 20px; }
        p { margin-bottom: 20px; font-size: 16px; }
        #userInfo { font-weight: 600; color: #764ba2; margin-bottom: 30px; }
        #logoutBtn {
            padding: 10px 20px;
            background: #f44336; /* लाल रंग */
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }
        #logoutBtn:hover { 
            background: #d32f2f; 
        }
        /* लोडिंग स्क्रीन स्टाइलिंग */
        .loading-screen {
            font-size: 20px;
            color: #667eea;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
    </style>
</head>
<body>
    
    <div class="loading-screen" id="loadingScreen">
        Loading dashboard...
    </div>

    <div class="dashboard-container" id="dashboardContent">
        <h1>Welcome to Habit Tracker!</h1>
        <p>This is your personal dashboard, where your habits will be tracked.</p>
        <p id="userInfo">You are logged in as: </p>
        <button id="logoutBtn">Logout</button>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    
    <script src="config.js"></script>

    <script>
        const loadingScreen = document.getElementById('loadingScreen');
        const dashboardContent = document.getElementById('dashboardContent');
        const userInfo = document.getElementById('userInfo');
        const logoutBtn = document.getElementById('logoutBtn');

        // शुरुआत में, लोडिंग दिखाएँ
        loadingScreen.style.display = 'flex';
        dashboardContent.style.display = 'none';
        
        // ** Firebase सुरक्षा जाँच (Security Check) **
        // Auth State बदलने पर यह फ़ंक्शन चलता है (जैसे: पेज लोड होने पर)
        firebase.auth().onAuthStateChanged(user => {
            if (!user) {
                // 1. यदि उपयोगकर्ता लॉग इन नहीं है, तो तुरंत लॉगिन पेज पर रीडायरेक्ट करें
                window.location.href = 'login-final.html'; 
            } else {
                // 2. उपयोगकर्ता लॉग इन है
                
                // लोडिंग स्क्रीन छिपाएँ और डैशबोर्ड दिखाएँ
                loadingScreen.style.display = 'none';
                dashboardContent.style.display = 'block';
                
                // उपयोगकर्ता की जानकारी प्रदर्शित करें
                userInfo.textContent = 'You are logged in as: ' + user.email;

                // ** लॉगआउट फ़ंक्शन **
                // 3. Logout बटन पर क्लिक होने पर
                logoutBtn.addEventListener('click', () => {
                    firebase.auth().signOut()
                        .then(() => {
                            // सफलतापूर्वक लॉगआउट होने पर,
                            // onAuthStateChanged फ़ंक्शन फिर से चलेगा और login-final.html पर रीडायरेक्ट करेगा
                            console.log('User logged out successfully.');
                        })
                        .catch((error) => {
                            console.error('Logout failed:', error);
                            alert('Logout failed. Please try again.');
                        });
                });
            }
        });
    </script>
</body>
</html>
